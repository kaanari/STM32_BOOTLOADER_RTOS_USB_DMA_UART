/*
 * bootloader.c
 *
 *  Created on: Sep 1, 2022
 *      Author: kaanari
 */
#include "bootloader.h"


void bootloader(void)
{

	printf("Bootloader is running...\r\n");

	uint8_t status = check_applications();



	printf("%X\r\n",status);
}


/* This function is used for checking if applications
 * that resides in each sector of the memory exists */
boot_information_t check_applications()
{
	uint8_t status = 0;
	uint8_t app_num = 0;
	uint32_t* app_start_address = 0;
	for(; app_num < NUMBER_OF_APP; app_num++)
	{
		app_start_address = BOOTLOADER_ADDRESS + FLASH_SECTOR_SIZE*(app_num+1);
		if(*app_start_address >= APP_ADDRESS_SPACE_LOW && *app_start_address <= APP_ADDRESS_SPACE_MAX){
			printf("APP%d is presented.\r\n", app_num+1);
			status = status ^ (1 << app_num);
		}else{
			printf("APP%d is NOT presented.\r\n", app_num+1);
		}
	}


	return status;
}
